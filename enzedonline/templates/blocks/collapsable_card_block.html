{% load static wagtailcore_tags collapsable_card_tags %} 
{% button_colour value.header_colour as banner %}

<div class="block-container">
  <div class="accordion border-{{ banner.border }}" id="collapsable_card_block{{ block.id }}">
    {% for card in value.cards %}
      <div class="accordion-item">
        <h2 class="accordion-header" id="header{{ block.id }}-{{ forloop.counter }}">
          <button class="accordion-button {{ self.header_colour }}{% if not forloop.first %} collapsed{% endif %}" 
            type="button" 
            data-bs-toggle="collapse" 
            data-bs-target="#collapse{{ block.id }}-{{ forloop.counter }}" 
            aria-expanded={% if forloop.first %}"true"{% else %}"false"{% endif %} 
            aria-controls="collapse{{ block.id }}-{{ forloop.counter }}"
            >
            {{ card.value.header|title }}
          </button>
        </h2>
        <div id="collapse{{ block.id }}-{{ forloop.counter }}" 
          class="accordion-collapse collapse{% if forloop.first %} show{% endif %}" 
          aria-labelledby="heading{{ forloop.counter }}" 
          data-bs-parent="#collapsable_card_block{{ block.id }}"
          >
          <div class="accordion-body {{ self.body_colour }}">
            {% include_block card.value.text %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<script src="{% static 'js/collapsable_card.js'%}"></script>
