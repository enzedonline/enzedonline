{% load wagtailcore_tags %}

<div class="{{ self.background }} p-1 mb-3">
    {{ block.value.video|safe }}
    {% if block.value.caption %}
        <div class="text-end pe-1">{{ block.value.caption }}</div>
    {% endif %}
</div>

{% comment %} 
The following will stop a YouTube video showing any suggestions at the end
<div id="player"></div> 
<script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
        width: '100%',
        videoId: 'Wch3gJG2GJ4',
        
        events: {
            'onReady': onPlayerReady,
            'onStateChange': function(event){
                switch(event.data){
                    // Stop the video once video ends, it prevent Suggestions/Recommended video to pop up.
                    case 0:     // when video ends
                    player.stopVideo();
                    break;
                    default:
                    break;
                }
            }
        }
        });
    }

    function onPlayerReady(event) {
        event.target.pauseVideo();
    }
</script>  
{% endcomment %}